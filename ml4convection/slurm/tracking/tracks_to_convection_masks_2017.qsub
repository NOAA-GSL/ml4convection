#!/usr/bin/bash

#SBATCH --job-name="tracks_to_convection_masks_2017"
#SBATCH --ntasks=1
#SBATCH --nodes=1
#SBATCH --mem=8G
#SBATCH --partition="swat_plus"
#SBATCH --time=04:00:00
#SBATCH --array=0-364
#SBATCH --mail-type=BEGIN,END,FAIL
#SBATCH --mail-user=ryan.lagerquist@ou.edu
#SBATCH --output=tracks_to_convection_masks_2017_%A_%a.out

TOP_RADAR_DIR_NAME="/condo/swatwork/ralager/taiwan/radar_data"
TOP_TRACKING_DIR_NAME="${TOP_RADAR_DIR_NAME}/storm_tracking/final"
TOP_MASK_DIR_NAME="${TOP_TRACKING_DIR_NAME}/masks"

DATE_STRINGS=("20170101" "20170102" "20170103" "20170104" "20170105" "20170106" "20170107" "20170108" "20170109" "20170110" "20170111" "20170112" "20170113" "20170114" "20170115" "20170116" "20170117" "20170118" "20170119" "20170120" "20170121" "20170122" "20170123" "20170124" "20170125" "20170126" "20170127" "20170128" "20170129" "20170130" "20170131" "20170201" "20170202" "20170203" "20170204" "20170205" "20170206" "20170207" "20170208" "20170209" "20170210" "20170211" "20170212" "20170213" "20170214" "20170215" "20170216" "20170217" "20170218" "20170219" "20170220" "20170221" "20170222" "20170223" "20170224" "20170225" "20170226" "20170227" "20170228" "20170301" "20170302" "20170303" "20170304" "20170305" "20170306" "20170307" "20170308" "20170309" "20170310" "20170311" "20170312" "20170313" "20170314" "20170315" "20170316" "20170317" "20170318" "20170319" "20170320" "20170321" "20170322" "20170323" "20170324" "20170325" "20170326" "20170327" "20170328" "20170329" "20170330" "20170331" "20170401" "20170402" "20170403" "20170404" "20170405" "20170406" "20170407" "20170408" "20170409" "20170410" "20170411" "20170412" "20170413" "20170414" "20170415" "20170416" "20170417" "20170418" "20170419" "20170420" "20170421" "20170422" "20170423" "20170424" "20170425" "20170426" "20170427" "20170428" "20170429" "20170430" "20170501" "20170502" "20170503" "20170504" "20170505" "20170506" "20170507" "20170508" "20170509" "20170510" "20170511" "20170512" "20170513" "20170514" "20170515" "20170516" "20170517" "20170518" "20170519" "20170520" "20170521" "20170522" "20170523" "20170524" "20170525" "20170526" "20170527" "20170528" "20170529" "20170530" "20170531" "20170601" "20170602" "20170603" "20170604" "20170605" "20170606" "20170607" "20170608" "20170609" "20170610" "20170611" "20170612" "20170613" "20170614" "20170615" "20170616" "20170617" "20170618" "20170619" "20170620" "20170621" "20170622" "20170623" "20170624" "20170625" "20170626" "20170627" "20170628" "20170629" "20170630" "20170701" "20170702" "20170703" "20170704" "20170705" "20170706" "20170707" "20170708" "20170709" "20170710" "20170711" "20170712" "20170713" "20170714" "20170715" "20170716" "20170717" "20170718" "20170719" "20170720" "20170721" "20170722" "20170723" "20170724" "20170725" "20170726" "20170727" "20170728" "20170729" "20170730" "20170731" "20170801" "20170802" "20170803" "20170804" "20170805" "20170806" "20170807" "20170808" "20170809" "20170810" "20170811" "20170812" "20170813" "20170814" "20170815" "20170816" "20170817" "20170818" "20170819" "20170820" "20170821" "20170822" "20170823" "20170824" "20170825" "20170826" "20170827" "20170828" "20170829" "20170830" "20170831" "20170901" "20170902" "20170903" "20170904" "20170905" "20170906" "20170907" "20170908" "20170909" "20170910" "20170911" "20170912" "20170913" "20170914" "20170915" "20170916" "20170917" "20170918" "20170919" "20170920" "20170921" "20170922" "20170923" "20170924" "20170925" "20170926" "20170927" "20170928" "20170929" "20170930" "20171001" "20171002" "20171003" "20171004" "20171005" "20171006" "20171007" "20171008" "20171009" "20171010" "20171011" "20171012" "20171013" "20171014" "20171015" "20171016" "20171017" "20171018" "20171019" "20171020" "20171021" "20171022" "20171023" "20171024" "20171025" "20171026" "20171027" "20171028" "20171029" "20171030" "20171031" "20171101" "20171102" "20171103" "20171104" "20171105" "20171106" "20171107" "20171108" "20171109" "20171110" "20171111" "20171112" "20171113" "20171114" "20171115" "20171116" "20171117" "20171118" "20171119" "20171120" "20171121" "20171122" "20171123" "20171124" "20171125" "20171126" "20171127" "20171128" "20171129" "20171130" "20171201" "20171202" "20171203" "20171204" "20171205" "20171206" "20171207" "20171208" "20171209" "20171210" "20171211" "20171212" "20171213" "20171214" "20171215" "20171216" "20171217" "20171218" "20171219" "20171220" "20171221" "20171222" "20171223" "20171224" "20171225" "20171226" "20171227" "20171228" "20171229" "20171230" "20171231")

this_date_string=${DATE_STRINGS[$SLURM_ARRAY_TASK_ID]}
echo "Array index = ${SLURM_ARRAY_TASK_ID} ... date = ${this_date_string}"

/home/ralager/anaconda3/bin/python3.6 -u "/condo/swatwork/ralager/ml4convection/ml4convection/scripts/tracks_to_convection_masks.py" \
--input_tracking_dir_name="${TOP_TRACKING_DIR_NAME}" \
--first_date_string="${this_date_string}" \
--last_date_string="${this_date_string}" \
--output_mask_dir_name="${TOP_MASK_DIR_NAME}"
