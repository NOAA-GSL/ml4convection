#!/usr/bin/bash

#SBATCH --job-name="tracks_to_convection_masks_2018"
#SBATCH --ntasks=1
#SBATCH --nodes=1
#SBATCH --mem=8G
#SBATCH --partition="swat_plus"
#SBATCH --time=04:00:00
#SBATCH --array=0-365
#SBATCH --mail-type=BEGIN,END,FAIL
#SBATCH --mail-user=ryan.lagerquist@ou.edu
#SBATCH --output=tracks_to_convection_masks_2018_%A_%a.out

TOP_RADAR_DIR_NAME="/condo/swatwork/ralager/taiwan/radar_data"
TOP_TRACKING_DIR_NAME="${TOP_RADAR_DIR_NAME}/storm_tracking/final"
TOP_MASK_DIR_NAME="${TOP_TRACKING_DIR_NAME}/masks"

DATE_STRINGS=("20180101" "20180102" "20180103" "20180104" "20180105" "20180106" "20180107" "20180108" "20180109" "20180110" "20180111" "20180112" "20180113" "20180114" "20180115" "20180116" "20180117" "20180118" "20180119" "20180120" "20180121" "20180122" "20180123" "20180124" "20180125" "20180126" "20180127" "20180128" "20180129" "20180130" "20180131" "20180201" "20180202" "20180203" "20180204" "20180205" "20180206" "20180207" "20180208" "20180209" "20180210" "20180211" "20180212" "20180213" "20180214" "20180215" "20180216" "20180217" "20180218" "20180219" "20180220" "20180221" "20180222" "20180223" "20180224" "20180225" "20180226" "20180227" "20180228" "20180229" "20180301" "20180302" "20180303" "20180304" "20180305" "20180306" "20180307" "20180308" "20180309" "20180310" "20180311" "20180312" "20180313" "20180314" "20180315" "20180316" "20180317" "20180318" "20180319" "20180320" "20180321" "20180322" "20180323" "20180324" "20180325" "20180326" "20180327" "20180328" "20180329" "20180330" "20180331" "20180401" "20180402" "20180403" "20180404" "20180405" "20180406" "20180407" "20180408" "20180409" "20180410" "20180411" "20180412" "20180413" "20180414" "20180415" "20180416" "20180417" "20180418" "20180419" "20180420" "20180421" "20180422" "20180423" "20180424" "20180425" "20180426" "20180427" "20180428" "20180429" "20180430" "20180501" "20180502" "20180503" "20180504" "20180505" "20180506" "20180507" "20180508" "20180509" "20180510" "20180511" "20180512" "20180513" "20180514" "20180515" "20180516" "20180517" "20180518" "20180519" "20180520" "20180521" "20180522" "20180523" "20180524" "20180525" "20180526" "20180527" "20180528" "20180529" "20180530" "20180531" "20180601" "20180602" "20180603" "20180604" "20180605" "20180606" "20180607" "20180608" "20180609" "20180610" "20180611" "20180612" "20180613" "20180614" "20180615" "20180616" "20180617" "20180618" "20180619" "20180620" "20180621" "20180622" "20180623" "20180624" "20180625" "20180626" "20180627" "20180628" "20180629" "20180630" "20180701" "20180702" "20180703" "20180704" "20180705" "20180706" "20180707" "20180708" "20180709" "20180710" "20180711" "20180712" "20180713" "20180714" "20180715" "20180716" "20180717" "20180718" "20180719" "20180720" "20180721" "20180722" "20180723" "20180724" "20180725" "20180726" "20180727" "20180728" "20180729" "20180730" "20180731" "20180801" "20180802" "20180803" "20180804" "20180805" "20180806" "20180807" "20180808" "20180809" "20180810" "20180811" "20180812" "20180813" "20180814" "20180815" "20180816" "20180817" "20180818" "20180819" "20180820" "20180821" "20180822" "20180823" "20180824" "20180825" "20180826" "20180827" "20180828" "20180829" "20180830" "20180831" "20180901" "20180902" "20180903" "20180904" "20180905" "20180906" "20180907" "20180908" "20180909" "20180910" "20180911" "20180912" "20180913" "20180914" "20180915" "20180916" "20180917" "20180918" "20180919" "20180920" "20180921" "20180922" "20180923" "20180924" "20180925" "20180926" "20180927" "20180928" "20180929" "20180930" "20181001" "20181002" "20181003" "20181004" "20181005" "20181006" "20181007" "20181008" "20181009" "20181010" "20181011" "20181012" "20181013" "20181014" "20181015" "20181016" "20181017" "20181018" "20181019" "20181020" "20181021" "20181022" "20181023" "20181024" "20181025" "20181026" "20181027" "20181028" "20181029" "20181030" "20181031" "20181101" "20181102" "20181103" "20181104" "20181105" "20181106" "20181107" "20181108" "20181109" "20181110" "20181111" "20181112" "20181113" "20181114" "20181115" "20181116" "20181117" "20181118" "20181119" "20181120" "20181121" "20181122" "20181123" "20181124" "20181125" "20181126" "20181127" "20181128" "20181129" "20181130" "20181201" "20181202" "20181203" "20181204" "20181205" "20181206" "20181207" "20181208" "20181209" "20181210" "20181211" "20181212" "20181213" "20181214" "20181215" "20181216" "20181217" "20181218" "20181219" "20181220" "20181221" "20181222" "20181223" "20181224" "20181225" "20181226" "20181227" "20181228" "20181229" "20181230" "20181231")

this_date_string=${DATE_STRINGS[$SLURM_ARRAY_TASK_ID]}
echo "Array index = ${SLURM_ARRAY_TASK_ID} ... date = ${this_date_string}"

/home/ralager/anaconda3/bin/python3.6 -u "/condo/swatwork/ralager/ml4convection/ml4convection/scripts/tracks_to_convection_masks.py" \
--input_tracking_dir_name="${TOP_TRACKING_DIR_NAME}" \
--first_date_string="${this_date_string}" \
--last_date_string="${this_date_string}" \
--output_mask_dir_name="${TOP_MASK_DIR_NAME}"
